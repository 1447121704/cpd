language: cpp

compiler:
    - clang
    - gcc

env:
    - CPD_64BIT=true CPD_USE_ARMA_WRAPPER=true
    - CPD_64BIT=true CPD_USE_ARMA_WRAPPER=false
    - CPD_64BIT=false CPD_USE_ARMA_WRAPPER=true
    - CPD_64BIT=false CPD_USE_ARMA_WRAPPER=false

install:
    - scripts/install_compilers.sh
    - scripts/install_cmake.sh
    - sudo apt-get install liblapack-dev libarpack2-dev libsuperlu3-dev gfortran
    - scripts/install_armadillo.sh
    - scripts/install_figtree.sh
    - sudo pip install cpp-coveralls

before_script:
    - if [[ $CXX == "g++" ]]; then
      export CPD_BUILD_COVERAGE="ON";
      export CXX="g++-4.8";
      else
      export CPD_BUILD_COVERAGE="OFF";
      fi

script:
    - scripts/build_and_test.sh

after_script:
    - if [[ $CPD_BUILD_COVERAGE == "ON" ]]; then
      scripts/coveralls.sh;
      fi
